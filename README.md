# Проект 3-го спринта

### ***Этап 1***
Пайплайн, который вы сделали в этом спринте, работает, и ваши коллеги уже успешно им пользуются. На данных из витрины mart.f_sales BI-аналитики построили графики total revenue для различных срезов.
Система магазина продолжает развиваться: команда разработки добавила функционал отмены заказов и возврата средств (refunded). Значит, процессы в пайплайне нужно обновить.

### ***Этап 2***
Ваши коллеги решили лучше изучить поведение клиентов. Для этого они хотят исследовать возвращаемость клиентов, или customer retention.
Выяснилось, что на текущий момент отчёт по customer retention строится очень долго. Коллеги попросили вас вычислить нужные метрики в дополнительной витрине.
Эта витрина должна отражать следующую информацию:
* Рассматриваемый период — weekly.
* Возвращаемость клиентов:
	* new — кол-во клиентов, которые оформили один заказ за рассматриваемый период;
	* returning — кол-во клиентов, которые оформили более одного заказа за рассматриваемый период;
	* refunded — кол-во клиентов, которые вернули заказ за рассматриваемый период.
* Доход (revenue) и refunded для каждой категории покупателей.

Благодаря витрине можно будет выяснить, какие категории товаров лучше всего удерживают клиентов.


### ***Этап 3***

В понедельник вы пришли на работу, проверили систему мониторинга и не нашли никаких неполадок. Однако коллеги-разработчики сообщили, что из-за бага в бэкенде данные из источника за воскресенье пришли неполные. Баг починили, данные инкремента восстановили, и теперь вам нужно сделать так, чтобы данные в аналитической системе отражали реальную картину.